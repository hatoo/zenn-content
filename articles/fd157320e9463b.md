---
title: "Aeneasã§Rustãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ¤œè¨¼ã—ã¦ã¿ãŸ"
emoji: "ğŸ“˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["aeneas", "rust", "lean"]
published: false
---

# ã¯ã˜ã‚ã«

[Aeneas](https://github.com/AeneasVerif/aeneas)ã¯Rustãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ¤œè¨¼ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ãƒã‚§ã‚¤ãƒ³ã§ã™ã€‚
[Charon](https://github.com/AeneasVerif/charon)ãŒRustã‚³ãƒ¼ãƒ‰ã‚’LLBCã¨å‘¼ã°ã‚Œã‚‹å½¢å¼ã«å¤‰æ›ã—ã¦ãã‚Œã¦ã€ãã‚Œã‚’Aeneasã«èª­ã¾ã›ã‚‹ã¨F*, Coq, HOL4, LEANã®ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›ã—ã¦ãã‚Œã¾ã™ã€‚

ç­†è€…ã¯Leanåˆå¿ƒè€…ã§ã™ãŒã€ä»Šå›ã¯å®Ÿéš›ã«Rustã‚³ãƒ¼ãƒ‰ã‚’Leanã§æ¤œè¨¼ã—ã¦ã¿ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚

```mermaid
graph TB
    Rustã‚³ãƒ¼ãƒ‰ -->|Charon| LLBC
    LLBC -->|Aeneas| Lean
```

# Aeneasã®Rustãƒ¢ãƒ‡ãƒ«

Aeneasã®Leanã‚³ãƒ¼ãƒ‰ã§ã¯Rustã®å¼ã‚’è©•ä¾¡ã—ãŸçµæœã¨ã—ã¦ä»¥ä¸‹ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™

```lean
inductive Error where
   | assertionFailure: Error -- assertionå¤±æ•—
   | integerOverflow: Error -- ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ ç‰¹ã«ãƒªãƒªãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰ã§ã¯ãƒã‚§ãƒƒã‚¯ã•ã‚Œãªã„ã‚„ã¤
   | divisionByZero: Error -- 0é™¤ç®—
   | arrayOutOfBounds: Error -- é…åˆ—ã®ç¯„å›²å¤–ã‚’å‚ç…§ã—ãŸ
   | maximumSizeExceeded: Error -- é…åˆ—ã®ã‚µã‚¤ã‚ºãŒusizeã‚’è¶…ãˆãŸ
   | panic: Error -- ãƒ‘ãƒ‹ãƒƒã‚¯
   | undef: Error -- æœªå®šç¾©
deriving Repr, BEq

open Error

inductive Result (Î± : Type u) where
  | ok (v: Î±): Result Î± -- æˆåŠŸ
  | fail (e: Error): Result Î± -- ãã‚Œä»¥å¤–
  | div -- ã“ã‚Œã¯Nonemptyã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã ã‘ã®ã‚„ã¤ã ã¨æ€ã†ã®ã§ç„¡è¦–
deriving Repr, BEq
```

ä¾‹ãˆã°ã€ã‚ã‚‹é–¢æ•°ãŒ(ã‚ã‚‹çŠ¶æ³ä¸‹ã§)å¿…ãšæˆåŠŸã™ã‚‹ã“ã¨ã¨ã‹ãŒè¨¼æ˜ã§ãã‚Œã°ã†ã‚Œã—ãã†

# ã‚„ã£ã¦ã¿ã‚‹

å®Ÿéš›ã«ãªã«ã‹è¨¼æ˜ã—ã¦ã¿ã¾ã™

é©å½“ã«Rustãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚Šã¾ã™
```sh
cargo new sandbox
```

é©å½“ã«é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™

```rust:main.rs
pub fn add(a: i32, b: i32) -> i32 {
    a + b
}
```

Charonã§LLBCã«å¤‰æ›ã—ã¾ã™

```sh
charon cargo --preset=aeneas
```

ã“ã‚Œã§`sanbox.llbc`ãŒã§ãã¾ã™ã€‚
LLBCè‡ªä½“ã¯JSONã§ã™ãŒä¸­èº«ã¯äººç”¨ã§ã¯ãªã„ã®ã§ã‚ˆãã‚ã‹ã‚Šã¾ã›ã‚“ã€‚

aeneasã§Leanã«å¤‰æ›ã—ã¾ã™

```sh
aeneas -backend lean sandbox.llbc
```

ã“ã‚Œã§Rustãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’Leanã«å¤‰æ›ã—ãŸã‚„ã¤ãŒã§ãã¾ã™

```lean
-- THIS FILE WAS AUTOMATICALLY GENERATED BY AENEAS
-- [sandbox]
import Aeneas
open Aeneas.Std Result Error
set_option linter.dupNamespace false
set_option linter.hashCommand false
set_option linter.unusedVariables false

namespace sandbox

/- [sandbox::main]:
   Source: 'src/main.rs', lines 1:0-1:12 -/
def main : Result Unit :=
  ok ()

/- [sandbox::add]:
   Source: 'src/main.rs', lines 3:0-5:1 -/
def add (a : I32) (b : I32) : Result I32 :=
  a + b
```

ã‚ã¨ã¯é©å½“ã«Leanãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã£ã¦Aeneasã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è¿½åŠ ã—ã¦å¥½ãã«ã™ã‚‹ã ã‘ã§ã™ã€‚
